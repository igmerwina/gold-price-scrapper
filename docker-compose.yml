version: '3.8'

services:
  gold-scraper:
    build: .
    container_name: gold-scraper
    environment:
      - SUPABASE_HOST=${SUPABASE_HOST}
      - SUPABASE_PORT=${SUPABASE_PORT}
      - SUPABASE_USER=${SUPABASE_USER}
      - SUPABASE_PASSWORD=${SUPABASE_PASSWORD}
      - SUPABASE_DB=${SUPABASE_DB}
      - SUPABASE_SSL_MODE=${SUPABASE_SSL_MODE}
      - CRON_SCHEDULE=${CRON_SCHEDULE}
      - TZ=Asia/Jakarta
    volumes:
      - ./scheduler/logs:/app/logs
      - ./sql:/app/sql
    restart: unless-stopped
    # Uncomment untuk health check
    # healthcheck:
    #   test: ["CMD", "test", "-f", "/app/logs/scraper_*.log"]
    #   interval: 1h
    #   timeout: 10s
    #   retries: 3
